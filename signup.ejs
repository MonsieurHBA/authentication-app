<%- include('partials/header'); -%>



<form>
    <h2>Sign up</h2>
    <label for="Email">Email</label>
    <input type="text" name="Email" required>
    <div class="Email error"></div>
    <label for="Password">Password</label>
    <input type="password" name="Password" required>
    <div class="Password error"></div>
    <button class="bouton">Sign up</button>

</form>


<script>
    // hedha pour front end ki na3ml submit chneya ysyr
    const form = document.querySelector('form') ;
    // bech nejbed blayes les erreurs bech n7ot fyhom el message d'erreur mtaa kol wahda
    const EmailError = document.querySelector('.Email.error') ;
    const PasswordError = document.querySelector('.Password.error') ;



    form.addEventListener('submit' , async (e)=>{
        e.preventDefault() ; // tna7i e refrech mtaa page
        // get the value from the input
        const Email = form.Email.value ;   //name="Email"
        const Password = form.Password.value ;  // name="Password"
        try {
            const res = await fetch('/signup' , {
                method: 'POST' ,
                body: JSON.stringify({Email , Password}),
                headers: {'Content-Type': 'application/json'}
            })
            // nheb naffichi eli 3malto  res.status(201).json({user: user._id}) fi AuthController.js ken ta3mal user succes bech ybenli el id f console mtaa front end si nn bech ybeno les erreur eli deja 3malthom ena f AuthController
            const data = await res.json();
            console.log(data) ;
            // tawa bech n7ot les erreurs fi blayeshom
            if(data.errors) {
                EmailError.textContent = data.errors.Email ;
                PasswordError.textContent = data.errors.Password ;
            }
            if(data.user) {
                location.assign('/') ;
            }
        }
        catch(err) {
            console.log(err) ;
        }
    })
</script>











<%- include('partials/footer'); -%>